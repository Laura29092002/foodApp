<div class="table-ing">
    <div class="h2">
        <img src="https://img.icons8.com/?size=100&id=4GLxWBxj9TSR&format=png&color=774b2e" alt="Fast food">
        <h2>Gestionnaire des ingrédients</h2>
    </div>
@if(isOpen){
    <app-ingredient-form (add)="reload($event)"></app-ingredient-form>
    <button (click)="addIngredient()" class="cancel">
        <img src="https://img.icons8.com/?size=100&id=83143&format=png&color=FFDB4D">
        Annuler
    </button>
}@else{
    <button (click)="addIngredient()">
        <img src="https://img.icons8.com/?size=100&id=85096&format=png&color=774b2e" alt="add">
        Ajouter un ingrédient
    </button>
}

@if(isloading){
    <app-loader/>
}


<table>
    <tr>
        <th>Nom</th>
        <th>Icone</th>
        <th>Unité</th>
        <th>Catégorie</th>
        <th></th>
        <th></th>
    </tr>
    @for(ingredient of ingredients; let i = $index; track ingredient.id){
        <tr>
            @if(editingId === ingredient.id){
                <td><input type="text" [(ngModel)]="editedIngredient.name" /></td>
                <td>@if(editedIngredient.image){
                    <span (click)="changeEmoji()" class="icon">{{ editedIngredient.image }}</span>
      
                    }@if(isIcon){
                      <emoji-mart 
                      (emojiSelect)="addEmoji($event)"
                      [include]="['foods']"
                      [set]="'google'"
                      [emoji]="'tomato'"
                      title="Choisir un ingrédient">
                    </emoji-mart>
                    }</td>
                <td><input type="text" [(ngModel)]="editedIngredient.unit"/></td>
                <td><select type="number" [(ngModel)]="editedIngredient.categoryId">
                  <option value="">Choisir une catégorie</option>
                  @for(category of categories; track category.id){
                  <option [value]="category.id">{{category.name}}</option>
                  }
                </select></td>
                <td (click)="saveIngredient(i)" class="btn">
                    <img src="https://img.icons8.com/?size=100&id=7690&format=png&color=774b2e" alt="check" title="Valider"> 
                </td>
                <td (click)="cancelEdit()" class="btn">
                    <img src="https://img.icons8.com/?size=100&id=95771&format=png&color=774b2e" alt="cross" title="Suprimer">
                </td>
            }@else{
                <td>{{ingredient.name}}</td>
                <td>{{ingredient.image}}</td>
                @if(ingredient.unit){
                    <td>{{ingredient.unit}}</td>
                }@else {
                    <td class="not-unit">Sans unité</td>
                }
                <td>{{categories[ingredient.categoryId!-1].name}}</td>
                <td (click)="updateIngredient(ingredient)" class="btn" title="Modifier">
                    <img src="https://img.icons8.com/?size=100&id=59729&format=png&color=774b2e" alt="Ball Point Pen">
                </td>
                <td (click)="deleteIngredient(ingredient.id, i)" class="btn" title="Supprimer">
                    <img src="https://img.icons8.com/?size=100&id=67884&format=png&color=774b2e" alt="Delete">
                </td>
            }
        </tr>
    }
</table>
</div>